

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>RESTful API &mdash; Citizens Agenda v0.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Citizens Agenda v0.1 documentation" href="index.html" />
    <link rel="next" title="Types of documents" href="data.html" />
    <link rel="prev" title="Start with oauth and account registration" href="start.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="data.html" title="Types of documents"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="start.html" title="Start with oauth and account registration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Citizens Agenda v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="restful-api">
<h1>RESTful API<a class="headerlink" href="#restful-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-of-the-restful-api">
<h2>Overview of the RESTful API<a class="headerlink" href="#overview-of-the-restful-api" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-it-works">
<h3>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h3>
<p>Each of the api&#8217;s URI match a document or a subset of documents. HTTP methods define actions to do on the document(s).</p>
<p>Theses methods are:</p>
<blockquote>
<div><ul class="simple">
<li>GET :         retrieve a document or a subset of documents</li>
<li>POST :        create a new document</li>
<li>PUT :         update a document</li>
<li>DELETE :      delete a document</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="data-format">
<h3>Data format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h3>
<p>Only JSON format is supported. You must set the Content-Type header at application/json in all requests to the server.</p>
</div>
<div class="section" id="api-responses">
<h3>API responses<a class="headerlink" href="#api-responses" title="Permalink to this headline">¶</a></h3>
<p>The API&#8217;s responses contain the standards HTTP codes which are significant of what happened.</p>
<blockquote>
<div><ul class="simple">
<li>200 OK :                      all went successfully gone</li>
<li>201 Created :         a new document was created</li>
<li>204 Deleted :         a document was deleted</li>
<li>400 Bad Request : the request is malformed</li>
<li>401 Forbidden :       document ressource is forbidden</li>
<li>404 Not Found :       document is not found</li>
<li>500 Internal :        Server Error : a server internal error occurred</li>
</ul>
</div></blockquote>
<div class="section" id="api-structure">
<h4>API structure<a class="headerlink" href="#api-structure" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="uris">
<h3>URIs<a class="headerlink" href="#uris" title="Permalink to this headline">¶</a></h3>
<p>URI are prefixed with /api/, followed by the document’s type and optionnaly by the document identifier.</p>
<blockquote>
<div><p><em>URIs examples</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/&lt;</span><span class="n">DOCUMENT_ID</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="playing-with-the-api">
<h3>Playing with the API<a class="headerlink" href="#playing-with-the-api" title="Permalink to this headline">¶</a></h3>
<p>curl-oauth is used in examples bellow to make request to the server. If you&#8217;re not familiar with please take a look at <a class="reference external" href="https://github.com/oxys/curl-oauth">https://github.com/oxys/curl-oauth</a></p>
<ol class="arabic">
<li><p class="first">Get a document&#8217;s list</p>
<blockquote>
<div><p>It&#8217;s done by invoking the GET HTTP method on an URI like /api/&lt;DOCUMENT_TYPE&gt;/</p>
<p><em>Request</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/</span>
</pre></div>
</div>
<p><em>Response</em></p>
<p>The server returns data as below</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">    &quot;total_rows&quot;:&lt;Database Document&#39;s count&gt;,</span>
<span class="go">    &quot;offset&quot;: 0,</span>
<span class="go">    &quot;rows&quot;:[{</span>
<span class="go">           Document data...</span>
<span class="go">           }]</span>
<span class="go">    }</span>
</pre></div>
</div>
<ul class="simple">
<li>total_rows is the document count of the specified type in the database, not in the response.</li>
<li>rows contains the documents, see data structure for more explanations.</li>
<li>offset is the amount of documents that are skipped when request is paginated.</li>
</ul>
<p>1.1. Pagination</p>
<blockquote>
<div><p>Pagination is implemented by passing extra parameters in query string. These parameters are from and size.</p>
<p>from define the amount of document to skip, size define the amount of document to fetch.</p>
<p>For example</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api -X GET http://api-master.czagenda.oxys.net/api/&lt;DOCUMENT_TYPE&gt;/?from=10&amp;size=5</pre>
</div>
<p>This query will return documents from 10th to 15th</p>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">Get a document</p>
<blockquote>
<div><p>It&#8217;s done by invoking the  GET HTTP method on an URI like /api/&lt;DOCUMENT_TYPE&gt;/&lt;DOCUMENT_ID&gt;</p>
<p><em>Request</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/&lt;</span><span class="n">DOCUMENT_ID</span><span class="o">&gt;/</span>
</pre></div>
</div>
<p><em>Response</em></p>
<p>The server returns one document</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span> <span class="n">Document</span> <span class="n">data</span><span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Create a document</p>
<blockquote>
<div><p>It&#8217;s done by invoking the POST HTTP method on an URI like /api/&lt;DOCUMENT_TYPE&gt;/</p>
<p><em>Request</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">json</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/</span>  <span class="o">-</span><span class="n">d</span> <span class="s">&#39;{</span>
<span class="go">                &quot;an_attribute&quot; : &quot;a value&quot;, &quot;another_attribute&quot; : &quot;another value&quot;</span>
<span class="go">        }&#39;</span>
</pre></div>
</div>
<p><em>Response</em></p>
<p>The server returns the newly created document with some system attributes such as _id or _rev. Systems attributes are described HERE</p>
</div></blockquote>
</li>
<li><p class="first">Update a document</p>
<blockquote>
<div><p>It&#8217;s done by invoking the PUT HTTP method on an URI like /api/&lt;DOCUMENT_TYPE&gt;/&lt;DOCUMENT_ID&gt;</p>
<p><em>Request</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">json</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/</span>  <span class="o">-</span><span class="n">d</span> <span class="s">&#39;{</span>
<span class="go">                &quot;an_attribute&quot; : &quot;an updated value&quot;, &quot;another_attribute&quot; : &quot;another value&quot;</span>
<span class="go">        }&#39;</span>
</pre></div>
</div>
<p><em>Response</em></p>
<p>The server returns the updated document.</p>
</div></blockquote>
</li>
<li><p class="first">Delete a document</p>
<blockquote>
<div><p>It&#8217;s done by invoking the DEL HTTP method on an URI like /api/&lt;DOCUMENT_TYPE&gt;/&lt;DOCUMENT_ID&gt;</p>
<p><em>Request</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">X</span> <span class="n">DELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">api</span><span class="o">/&lt;</span><span class="n">DOCUMENT_TYPE</span><span class="o">&gt;/&lt;</span><span class="n">DOCUMENT_ID</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><em>Response</em></p>
<p>The server returns nothing</p>
</div></blockquote>
</li>
</ol>
</div>
</div>
<div class="section" id="specifics-of-the-api-by-document-type">
<h2>Specifics of the API by document type<a class="headerlink" href="#specifics-of-the-api-by-document-type" title="Permalink to this headline">¶</a></h2>
<div class="section" id="user">
<h3>User<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h3>
<p>User base uri is /user</p>
<ol class="arabic">
<li><p class="first">Create</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">json</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">user</span><span class="o">/</span>  <span class="o">-</span><span class="n">d</span> <span class="s">&#39;{</span>
<span class="go">                        &quot;firstName&quot; : &quot;John&quot;,</span>
<span class="go">                        &quot;lastName&quot; : &quot;Doe&quot;,</span>
<span class="go">                        &quot;email&quot; : &quot;john.doe@domain.com&quot;,</span>
<span class="go">                        &quot;login&quot; : &quot;john.doe&quot;</span>
<span class="go">                }&#39;</span>
</pre></div>
</div>
<p>Server response with the 201 code</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span>    <span class="p">{</span>
<span class="go">          &quot;id&quot;: &quot;/user/johndoe&quot;,</span>
<span class="go">          &quot;createDate&quot;: &quot;2011-10-04T08:19:16.753Z&quot;,</span>
<span class="go">          &quot;updateDate&quot;: &quot;2011-10-04T08:19:16.753Z&quot;,</span>
<span class="go">          &quot;login&quot;: &quot;john.doe&quot;,</span>
<span class="go">          &quot;firstName&quot;: &quot;John&quot;,</span>
<span class="go">          &quot;lastName&quot;: &quot;Doe&quot;,</span>
<span class="go">          &quot;isActive&quot;: false,</span>
<span class="go">          &quot;isStaff&quot;: false,</span>
<span class="go">          &quot;isSuperuser&quot;: false,</span>
<span class="go">          &quot;lastLogin&quot;: null,</span>
<span class="go">          &quot;dateJoined&quot;: null,</span>
<span class="go">          &quot;groups&quot;: &quot;/user/johndoe/groups&quot;</span>
<span class="go">        }</span>
</pre></div>
</div>
<p>Note that id was generated from the provided login.</p>
</div></blockquote>
</li>
<li><p class="first">Update</p>
<blockquote>
<div><p>You can make a request with partial data or with a complete data structure.</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api --json -X PUT http://api-master.czagenda.oxys.net/user/johndoe?pretty=true  -d '{
                "firstName" : "Jack"
        }'</pre>
</div>
<p>Server response with the 200 code</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;id&quot;: &quot;/user/johndoe&quot;,</span>
<span class="go">          &quot;createDate&quot;: &quot;2011-10-04T08:19:16.753Z&quot;,</span>
<span class="go">          &quot;updateDate&quot;: &quot;2011-10-04T08:24:30.840Z&quot;,</span>
<span class="go">          &quot;login&quot;: &quot;john.doe&quot;,</span>
<span class="go">          &quot;firstName&quot;: &quot;Jack&quot;,</span>
<span class="go">          &quot;lastName&quot;: &quot;Doe&quot;,</span>
<span class="go">          &quot;isActive&quot;: false,</span>
<span class="go">          &quot;isStaff&quot;: false,</span>
<span class="go">          &quot;isSuperuser&quot;: false,</span>
<span class="go">          &quot;lastLogin&quot;: null,</span>
<span class="go">          &quot;dateJoined&quot;: null,</span>
<span class="go">          &quot;groups&quot;: &quot;/user/johndoe/groups&quot;</span>
<span class="go">        }</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<ol class="arabic" start="2">
<li><p class="first">Delete</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">X</span> <span class="n">DELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">johndoe</span>
</pre></div>
</div>
<p>Server response with the 204 code and an empty body.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="group">
<h3>Group<a class="headerlink" href="#group" title="Permalink to this headline">¶</a></h3>
<p>Group base uri is /group</p>
<ol class="arabic">
<li><p class="first">Create</p>
<blockquote>
<div><div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api --json -X POST http://api-master.czagenda.oxys.net/group/?pretty=true  -d '{
                "title" : "My group",
                "description" : "Description of my first group"
        }'</pre>
</div>
<p>Server response with the 201 code</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;id&quot;: &quot;/group/my-group&quot;,</span>
<span class="go">          &quot;createDate&quot;: &quot;2011-10-04T08:32:01.231Z&quot;,</span>
<span class="go">          &quot;updateDate&quot;: &quot;2011-10-04T08:32:01.231Z&quot;,</span>
<span class="go">          &quot;title&quot;: &quot;My group&quot;,</span>
<span class="go">          &quot;description&quot;: &quot;Description of my first group&quot;,</span>
<span class="go">          &quot;writeGroups&quot;: &quot;/group/my-group/perms/wg&quot;,</span>
<span class="go">          &quot;writeUsers&quot;: &quot;/group/my-group/perms/wu&quot;,</span>
<span class="go">          &quot;users&quot;: &quot;/group/my-group/users&quot;</span>
<span class="go">        }</span>
</pre></div>
</div>
<p>Note that id was generated from the provided title.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="membership">
<h3>Membership<a class="headerlink" href="#membership" title="Permalink to this headline">¶</a></h3>
<p>Membership base uri is /membership</p>
<ol class="arabic">
<li><p class="first">Create</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">json</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">membership</span><span class="o">/</span>  <span class="o">-</span><span class="n">d</span> <span class="s">&#39;{</span>
<span class="go">                        &quot;user&quot; :  &quot;/user/johndoe&quot;,</span>
<span class="go">                        &quot;group&quot; : &quot;/group/my-group&quot;</span>
<span class="go">                }&#39;</span>
</pre></div>
</div>
<p>Server response with the 201 code</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;id&quot;: &quot;/membership/0b3bcb3a4b4fd153e2373f7ec49f5a57&quot;,</span>
<span class="go">          &quot;createDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">          &quot;updateDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">          &quot;group&quot;: &quot;/group/my-group&quot;,</span>
<span class="go">          &quot;user&quot;: &quot;/user/johndoe&quot;</span>
<span class="go">        }</span>
</pre></div>
</div>
<p>A membership document is a relation between a user and a group.</p>
</div></blockquote>
</li>
<li><p class="first">Get  user&#8217;s groups</p>
<blockquote>
<div><p>If you want to list all groups for a user just query the uri stored in the &#8220;group&#8221; attribute of the user document</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">johndoe</span><span class="o">/</span><span class="n">groups</span><span class="o">/</span>
</pre></div>
</div>
<p>Server response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;total_rows&quot;: 1,</span>
<span class="go">          &quot;offset&quot;: 0,</span>
<span class="go">          &quot;rows&quot;: [</span>
<span class="go">            {</span>
<span class="go">              &quot;group&quot;: &quot;/group/my-group&quot;,</span>
<span class="go">              &quot;createDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">              &quot;updateDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">              &quot;id&quot;: &quot;/membership/0b3bcb3a4b4fd153e2373f7ec49f5a57&quot;</span>
<span class="go">            }</span>
<span class="go">          ]</span>
<span class="go">        }</span>
</pre></div>
</div>
<p>The server will return all membership documents for the user. Observe that user attribute of the membership document is not here.</p>
<p>If you want in the same query fetch the group document you can do it with the special query string parameter include_docs</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api -X GET http://api-master.czagenda.oxys.net/user/johndoe/groups/?include_docs=true</pre>
</div>
<p>server response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;total_rows&quot;: 1,</span>
<span class="go">          &quot;offset&quot;: 0,</span>
<span class="go">          &quot;rows&quot;: [</span>
<span class="go">            {</span>
<span class="go">              &quot;group&quot;: {</span>
<span class="go">                &quot;title&quot;: &quot;My group&quot;,</span>
<span class="go">                &quot;users&quot;: &quot;/group/my-group/users&quot;,</span>
<span class="go">                &quot;description&quot;: &quot;Description of my first group&quot;,</span>
<span class="go">                &quot;writeUsers&quot;: &quot;/group/my-group/perms/wu&quot;,</span>
<span class="go">                &quot;createDate&quot;: &quot;2011-10-04T08:32:01.231Z&quot;,</span>
<span class="go">                &quot;updateDate&quot;: &quot;2011-10-04T08:32:01.231Z&quot;,</span>
<span class="go">                &quot;writeGroups&quot;: &quot;/group/my-group/perms/wg&quot;,</span>
<span class="go">                &quot;id&quot;: &quot;/group/my-group&quot;</span>
<span class="go">              },</span>
<span class="go">              &quot;createDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">              &quot;updateDate&quot;: &quot;2011-10-04T08:40:32.117Z&quot;,</span>
<span class="go">              &quot;id&quot;: &quot;/membership/0b3bcb3a4b4fd153e2373f7ec49f5a57&quot;</span>
<span class="go">            }</span>
<span class="go">          ]</span>
<span class="go">        }</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Get  group&#8217;s users</p>
<blockquote>
<div><p>You can fetch the group&#8217;s members by requesting on the &#8220;users&#8221; attribute of the group document</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">groups</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">group</span><span class="o">/</span><span class="n">users</span><span class="o">/</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api -X GET http://api-master.czagenda.oxys.net/groups/my-group/users/?include_docs=true</pre>
</div>
</div></blockquote>
</li>
<li><p class="first">Update</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Update are not allowed on membership uri.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">Delete</p>
<blockquote>
<div><p>To delete a membership relation, proceed in the same way as others documents</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">X</span> <span class="n">DELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">membership</span><span class="o">/</span><span class="mi">0</span><span class="n">b3bcb3a4b4fd153e2373f7ec49f5a57</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="agenda">
<h3>Agenda<a class="headerlink" href="#agenda" title="Permalink to this headline">¶</a></h3>
<p>Agenda base uri is /agenda</p>
<ol class="arabic">
<li><p class="first">Create</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">curl</span><span class="o">-</span><span class="n">oauth</span> <span class="o">--</span><span class="n">domain</span> <span class="n">cz</span><span class="o">-</span><span class="n">api</span> <span class="o">--</span><span class="n">json</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">czagenda</span><span class="o">.</span><span class="n">oxys</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">agenda</span><span class="o">/</span>  <span class="o">-</span><span class="n">d</span> <span class="s">&#39;{</span>
<span class="go">                        &quot;title&quot; : &quot;My private agenda&quot;,</span>
<span class="go">                        &quot;description&quot; : &quot;description of my private agenda&quot;</span>
<span class="go">                }&#39;</span>
</pre></div>
</div>
<p>Server response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">  &quot;id&quot;: &quot;/agenda/my-private-agenda&quot;,</span>
<span class="go">  &quot;createDate&quot;: &quot;2011-10-04T09:06:38.071Z&quot;,</span>
<span class="go">  &quot;updateDate&quot;: &quot;2011-10-04T09:06:38.071Z&quot;,</span>
<span class="go">  &quot;title&quot;: &quot;My private agenda&quot;,</span>
<span class="go">  &quot;description&quot;: &quot;description of my private agenda&quot;,</span>
<span class="go">  &quot;writeGroups&quot;: &quot;/agenda/my-private-agenda/perms/wg&quot;,</span>
<span class="go">  &quot;writeUsers&quot;: &quot;/agenda/my-private-agenda/perms/wu&quot;</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Note that id was generated from the provided title.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="event">
<h3>Event<a class="headerlink" href="#event" title="Permalink to this headline">¶</a></h3>
<p>Event base uri is /event</p>
<ol class="arabic">
<li><p class="first">Create</p>
<blockquote>
<div><div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api --json -X POST http://api-master.czagenda.oxys.net/event/?pretty=true  -d '{
                "event" : {
                        "title" : "My first event",
                        "where" : [{"valueString" : "Somewhere on earth planet !"}],
                        "links" : [{"rel" : "describedby", "href" : "/schema/event"}]
                }
        }'</pre>
</div>
<p>Data structure in the event attribute is written according to schema /schema/event. see <a class="reference external" href="schemas.html">schemas</a></p>
<p>Server response</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">          &quot;id&quot;: &quot;/event/b31398e4e0de03ef76bb168e32e41948&quot;,</span>
<span class="go">          &quot;createDate&quot;: &quot;2011-10-04T09:14:28.281Z&quot;,</span>
<span class="go">          &quot;updateDate&quot;: &quot;2011-10-04T09:14:28.281Z&quot;,</span>
<span class="go">          &quot;event&quot;: {</span>
<span class="go">            &quot;title&quot;: &quot;My first event&quot;,</span>
<span class="go">            &quot;where&quot; : [{&quot;valueString&quot; : &quot;Somewhere on earth planet !&quot;}],</span>
<span class="go">                &quot;links&quot; : [{&quot;rel&quot; : &quot;describedby&quot;, &quot;href&quot; : &quot;/schema/event&quot;}]</span>
<span class="go">          },</span>
<span class="go">          &quot;author&quot;: &quot;/user/johndoe&quot;,</span>
<span class="go">          &quot;writeGroups&quot;: &quot;/event/b31398e4e0de03ef76bb168e32e41948/perms/wg&quot;,</span>
<span class="go">          &quot;readGroups&quot;: &quot;/event/b31398e4e0de03ef76bb168e32e41948/perms/rg&quot;,</span>
<span class="go">          &quot;writeUsers&quot;: &quot;/event/b31398e4e0de03ef76bb168e32e41948/perms/wu&quot;,</span>
<span class="go">          &quot;readUsers&quot;: &quot;/event/b31398e4e0de03ef76bb168e32e41948/perms/ru&quot;,</span>
<span class="go">          &quot;agenda&quot;: null</span>
<span class="go">        }</span>
</pre></div>
</div>
<p>Note that author was automatically added according to your oauth domain</p>
</div></blockquote>
</li>
<li><p class="first">Search</p>
<blockquote>
<div><p>Geographic and date time searchs are implemented.</p>
<p>2.1. Geographic search</p>
<blockquote>
<div><p>Geographic search is a search that limits events contained in a bounding box.</p>
<p>For example</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; curl-oauth --domain cz-api -X GET http://api-master.czagenda.oxys.net/api/event/?bbox=&lt;TOP_LEFT_LATITUDE&gt;,&lt;TOP_LEFT_LONGITUDE&gt;,&lt;RIGHT_BOTTOM_LATITUDE&gt;,&lt;RIGHT_BOTTOM_LONGITUDE&gt;</pre>
</div>
</div></blockquote>
<p>2.2. Date time search</p>
<blockquote>
<div><p>Two parameters are availlable: start_time and end_time (optionnal)</p>
<p>Lorsque seul le paramètre start_time est fourni, les évènements retournés sont ceux pour lesquels la date fournie est comprise entre les dates de début et de fin de l&#8217;évènement.</p>
<p>Lorsque les deux paramètres start_time et end_time sont fournies, les évènements retournés sont ceux pour lesquels l&#8217;intersection des deux intervales de date n&#8217;est pas nul.</p>
</div></blockquote>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="permission">
<h3>Permission<a class="headerlink" href="#permission" title="Permalink to this headline">¶</a></h3>
<p>Permission documents are used to define access rights on documents.</p>
<dl class="docutils">
<dt>A permission document is composed of two attributes:</dt>
<dd><ul class="first last simple">
<li>grantTo which defines who has the permission. It could be a group or an user.</li>
<li>applyOn which defines the document on which the permission is applied.</li>
</ul>
</dd>
</dl>
<p>Base permission uri varies depending on the document type and the permission type.</p>
<dl class="docutils">
<dt>Permissions types are:</dt>
<dd><ul class="first last simple">
<li>write user</li>
<li>read user</li>
<li>write group</li>
<li>read group</li>
</ul>
</dd>
</dl>
<p>All documents types don&#8217;t have all permissions types.</p>
<ol class="arabic">
<li><p class="first">Permissions by document types</p>
<blockquote>
<div><p>1.1 Group</p>
<blockquote>
<div><p>Group have user and group write permissions.</p>
<p>To create a group permission</p>
</div></blockquote>
</div></blockquote>
</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">RESTful API</a><ul>
<li><a class="reference internal" href="#overview-of-the-restful-api">Overview of the RESTful API</a><ul>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
<li><a class="reference internal" href="#data-format">Data format</a></li>
<li><a class="reference internal" href="#api-responses">API responses</a><ul>
<li><a class="reference internal" href="#api-structure">API structure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#uris">URIs</a></li>
<li><a class="reference internal" href="#playing-with-the-api">Playing with the API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specifics-of-the-api-by-document-type">Specifics of the API by document type</a><ul>
<li><a class="reference internal" href="#user">User</a></li>
<li><a class="reference internal" href="#group">Group</a></li>
<li><a class="reference internal" href="#membership">Membership</a></li>
<li><a class="reference internal" href="#agenda">Agenda</a></li>
<li><a class="reference internal" href="#event">Event</a></li>
<li><a class="reference internal" href="#permission">Permission</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="start.html"
                        title="previous chapter">Start with oauth and account registration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="data.html"
                        title="next chapter">Types of documents</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/rest.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="data.html" title="Types of documents"
             >next</a> |</li>
        <li class="right" >
          <a href="start.html" title="Start with oauth and account registration"
             >previous</a> |</li>
        <li><a href="index.html">Citizens Agenda v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Oxys SARL.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
  </body>
</html>